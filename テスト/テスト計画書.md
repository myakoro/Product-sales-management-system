# Rinori 売上管理システム テスト計画書

## 1. 文書情報
- 文書名: Rinori 売上管理システム テスト計画書
- 対象システム: Rinori 売上管理システム
- 版数: 0.9（ドラフト）
- 作成日: 2025-12-09
- 想定読者: 開発担当者、テスト担当者（あなた + Cascade）、レビュー担当者

---

## 2. テストの目的
Rinori 売上管理システムが、要件定義書および詳細仕様書（V1.1〜V1.3）に従って正しく実装されていることを検証し、
本番運用に耐えうる品質であることを確認することを目的とする。

特に以下を重視する。
- 売上・予算・PL・広告費・税率等の**集計ロジック**が仕様通りであること
- CSV取込・マスタ編集などの**主要業務フロー**が仕様通りに動作すること
- **ユーザー権限（マスター／スタッフ）**に基づく表示・機能制御が仕様通りであること
- 画面間遷移・共通UIが**画面仕様書およびUI設計**と整合していること

---

## 3. テスト対象

### 3.1 対象成果物
- 仕様および設計系
  - `C:\Users\takuy\Desktop\売上管理システム\要件定義書\Rinori 売上管理システム 要件定義書_*.txt`
  - `C:\Users\takuy\Desktop\売上管理システム\仕様書\00_総合インデックス.md`
  - `C:\Users\takuy\Desktop\売上管理システム\仕様書\01_システム概要とDB設計.md`
  - `C:\Users\takuy\Desktop\売上管理システム\仕様書\02_CSV取込処理.md`
  - `C:\Users\takuy\Desktop\売上管理システム\仕様書\03_予算管理とPL計算.md`
  - `C:\Users\takuy\Desktop\売上管理システム\仕様書\04_画面仕様と画面遷移.md`
  - `C:\Users\takuy\Desktop\売上管理システム\仕様書\05_処理フローとバリデーション.md`
  - `C:\Users\takuy\Desktop\売上管理システム\UI設計\*.md`
- UIプロトタイプ
  - `C:\Users\takuy\Desktop\売上管理システム\プロトタイプ\index.html`
  - `C:\Users\takuy\Desktop\売上管理システム\プロトタイプ\pages\*.html`
  - `C:\Users\takuy\Desktop\売上管理システム\プロトタイプ\css\style.css`
  - `C:\Users\takuy\Desktop\売上管理システム\プロトタイプ\js\app.js`
  - `C:\Users\takuy\Desktop\売上管理システム\プロトタイプ\js\dummy-data.js`
- 動的実装（アンチグラビティ等で生成されるアプリケーション）
  - Webアプリ本体（フロントエンド + サーバサイド）
  - データベーススキーマ・マイグレーション
  - API群（CSV取込、マスタ編集、集計系API など）

### 3.2 機能範囲
仕様書の画面ID・機能単位で以下を対象とする。

- SC-01: トップページ / ダッシュボード
- SC-02: 売上CSV取込
- SC-03: 商品一覧CSV取込
- SC-04: CSV取込履歴
- SC-05: 商品マスタ一覧
- SC-06: 商品マスタ編集
- SC-07: 新商品候補一覧
- SC-09: 予算設定（期間予算 + 月別予算、Excel型UI）
- SC-11: 予算 vs 実績一覧
- SC-12: PL画面（月次・期間）
- SC-13: 商品別PL
- SC-14: 広告費管理（一覧 + 入力 + カテゴリ管理、タブUI）
- SC-18: 税率設定

### 3.3 対象外（V1.1/1.3時点で実装しない項目）
テスト対象から除外する機能（将来拡張／削除されたもの）。

- マルチブランド対応
- 日次PL（`sales_date` を用いた日次集計）
- 商品別広告費配賦
- 取込履歴のロールバック
- 広告費CSV取込機能
- 広告費カテゴリ管理の独立画面（SC-17）
- 不完全マスタ一覧画面（SC-19） ※警告バナーによる対応のみテスト対象

---

## 4. テストレベルとテスト種別

### 4.1 テストレベル
- 単体テスト
  - サーバサイドのドメインロジック
  - CSVパーサ・バリデーション関数
  - SKU→親コード変換ロジック
  - 期間予算配分ロジック
- 結合テスト
  - APIとDBの連携
  - CSV取込〜DB反映〜集計処理の一連の流れ
- システムテスト（E2E）
  - ブラウザ上での画面操作を通じた、業務フロー単位の確認
- 受入テスト
  - シナリオベースで、要件定義書レベルの満たし方を確認

### 4.2 テスト種別
- 機能テスト
- 画面UI/UXテスト（ナビゲーション、入力制御、表示制御）
- セキュリティ・権限制御テスト（認証・認可）
- 性能・簡易負荷テスト（CSV取込・集計処理が実用的な時間内で終わるかの目視確認レベル）
- 回帰テスト（機能追加・修正後の再確認）

---

## 5. テスト観点（高レベル）
※ここでは観点レベルに留め、個々のテストケースは別途「テスト仕様書」で定義する。

### 5.1 共通・全体
- ログイン必須画面で、未ログイン時にアクセス制御されるか
- マスター権限／スタッフ権限でのメニュー表示・画面表示差異
- エラー時のメッセージ表示形式（画面上部に赤字、複数エラーのリスト表示）
- 成功時のメッセージ表示（緑色、3秒後自動クローズ）
- 重要操作前の確認ダイアログ（削除・上書きなど）

### 5.2 CSV取込（SC-02, SC-03, SC-04, new_product_candidates 周辺）
- 売上CSV取込：
  - 対象年月・取込モード（追加／上書き）の挙動
  - 上書き時に該当月の既存実績が削除され再登録されること
  - 税込金額から税別金額への変換（税率テーブルに基づく）
  - `実績の即時反映`（月次PL・商品別PL・予算vs実績への反映タイミング）
- 商品一覧CSV取込：
  - 差分検出ロジック（新規／更新／無変更）
  - 一括選択（全選択／全解除）の動作
- CSV取込履歴：
  - import_histories テーブルと画面表示の整合
  - 取込種別・取込モード・対象年月・件数・ユーザー名の表示

### 5.3 商品マスタ・新商品候補（SC-05, SC-06, SC-07）
- 商品マスタ一覧：
  - 検索・フィルタ・ソートの挙動
  - 管理中／管理外ステータスに応じた集計対象制御
- 商品マスタ編集：
  - 必須項目・入力形式のバリデーション
  - 管理中商品の未設定項目が「不完全マスタ」として警告対象になるか
- 新商品候補一覧：
  - 売上CSVからの新候補検出ロジック
  - 候補のステータス遷移（pending → registered / ignored）

### 5.4 予算・PL（SC-09, SC-11, SC-12, SC-13）
- 期間予算・月別予算：
  - 期間合計 ↔ 月別数量のExcel型UI連動（双方向更新）
  - 端数処理：余りが最終月に寄せられること
  - 期間予算保存時の履歴レコード作成
- 予算 vs 実績：
  - 予算数量・実績数量・達成率の計算式
  - 管理外商品が集計から除外されていること
- PL画面（月次・期間）：
  - 売上・原価・粗利・広告費・営業利益および各率の計算
  - マスター権限のみ総合計を表示、スタッフ権限では非表示
- 商品別PL：
  - 期間選択・検索・ソート
  - 各商品行でのPL項目・率の計算

### 5.5 広告費・税率（SC-14, SC-18）
- 広告費管理：
  - 一覧タブでの行追加・編集・削除の挙動
  - カテゴリ管理タブでのカテゴリ追加・編集・削除
  - 日付・金額・カテゴリ・メモのバリデーション
- 税率設定：
  - start_ym と rate のバリデーション
  - 売上CSV取込時の税率決定ロジック（start_ym 以下の最新レコード）

---

## 6. テスト環境

### 6.1 ハードウェア・OS・ブラウザ
- クライアントPC: Windows 環境（ローカル開発マシン）
- ブラウザ: Google Chrome（最新版）

### 6.2 アプリケーション・データベース
- アプリケーション:
  - アンチグラビティ等で生成された Web アプリケーション一式
  - 必要に応じて `C:\Users\takuy\Desktop\売上管理システム\rinori-sales-system` などのプロジェクト配下に配置
- データベース:
  - 仕様書 `01_システム概要とDB設計.md` に定義された 11 テーブルが作成済みであること
  - テスト用初期データを投入（マスタ・税率など）

### 6.3 テストデータ
- ダミーデータ・サンプルCSV:
  - `C:\Users\takuy\Desktop\売上管理システム\サンプル\*.csv`
  - `プロトタイプ\js\dummy-data.js` の構造を参考にしたテストデータ
- 実運用に近いデータボリュームのCSV（必要に応じて別途作成）

---

## 7. テストスケジュール（案）

1. テスト計画・観点整理（本ドキュメント）
2. テスト仕様書（詳細テストケース）作成
3. 単体テスト（主に開発者）
4. 結合テスト
5. システムテスト（あなた + Cascade の共同）
6. 受入テスト

※具体的な日付・工数は実装状況を見て別途追記する。

---

## 8. 役割分担（案）

- あなた（人間）
  - 実ブラウザを用いた E2E 操作確認
  - 実データに近いCSVでの最終確認
  - 仕様の最終判断
- Cascade（AI）
  - 仕様書・コード・HTML/JS の静的レビュー
  - テスト仕様書作成支援
  - 観点漏れの指摘
  - ロジック・計算式の検算

---

## 9. テスト完了基準

- 高優先度機能（CSV取込、商品マスタ、予算・PL、広告費、税率、権限制御）について、定義したテストケースがすべて実行済みであること
- 重大度の高い不具合（例: システムエラー・誤集計・権限制御事故）が解消されていること
- 仕様書との不整合が残っていない、もしくは残件が明示され合意済みであること
- あなたが「初版として運用に載せられる」と判断できること

---

## 10. 今後のステップ

1. 本テスト計画書の内容をベースに、画面別・機能別の**テスト仕様書（詳細テストケース一覧）** を作成する。
2. テスト仕様書に基づき、Cascade による仕様・実装レビュー、およびあなたによるブラウザ操作テストを実施する。
3. 不具合・改善点をチケット化し、修正→再テストを繰り返す。
