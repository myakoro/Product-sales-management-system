# V1.565 実装前質問への回答

Windsurfからの質問に対し、設計意図およびシステム全体の整合性に基づき回答します。

---

### Q1. 商品マスタ画面のレイアウト - カテゴリー列の配置位置
**回答：案B：商品名の直後**
カテゴリーは商品の主要な属性であるため、商品名に隣接している方がユーザーにとって視認性が高くなります。

### Q2. カテゴリーフィルタの配置
**回答：案B：4列均等配置**
画面の横幅を有効に活用し、他のフィルタと並列に配置してください。

### Q3. 商品別PL分析画面の実装方式
**回答：案B：画面内に商品一覧テーブルを追加**
ユーザーが商品を選択しながら即座にグラフの変化を確認できることが重要です。画面の左側（または上部）にコンパクトなテーブルを配置し、チェックボックスで選択可能にしてください。

### Q4. グラフの初期表示挙動
**回答：その通りです。**
全体表示は常に表示し、個別比較が必要なタブでは案内メッセージを出して「選択を促す」という挙動で実装を進めてください。

### Q5. 予算実績画面の確認
**回答：ファイルは存在します。**
パスは `/src/app/budget/vs-actual/page.tsx` です。すでにファイルは存在し、V1.56ベースの実装がなされていますので、これに対してV1.565の比較機能を追加してください。

### Q6. 営業利益の表示制御
**回答：予算実績推移グラフには不要です。**
設計書（V1.565）の指示通り、PL推移グラフ（特に商品・カテゴリー別）において営業利益チェックボックスを非表示にしてください。予算実績推移には元々項目がないため、現状のままで問題ありません。

### Q7. カテゴリーフィルタのAPI連携
**回答：その通りです。**
- エンドポイント: `/api/categories`
- クエリ: `categoryId=unclassified` を使用してください（API側で対応済みです）。

### Q8. チェックボックスの選択制限UI
**回答：案A：5件選択時に他のチェックボックスを非活性化（Disabled）**
ユーザーが「これ以上選べない理由」を直感的に理解しやすく、無駄なアラートを出さないため、この方式を推奨します。

### Q9. グラフタイプ切替UI
**回答：案B：タブボタン**
既存のPL画面のタブUIと親和性が高く、現在どちらが選択されているかが一目で分かるため、タブボタン形式（セグメントコントロール）で実装してください。

### Q10. 昨年データの一括表示切替UI
**回答：案A：グラフヘッダーの右側（表示項目チェックボックスの前）**
「昨年対比」はグラフ全体のモードを切り替える重要なスイッチであるため、表示項目のチェックボックス群よりも左側（手前）に配置してください。

---

以上、回答内容に基づき実装計画の策定をお願いします。
バックエンドAPI（/api/charts/...）は、上記パラメータや挙動に合わせて最適化済みです。
