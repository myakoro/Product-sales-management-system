# アンチグラビティ実装用プロンプト

## 役割
あなたは「アンチグラビティ」を用いたWebアプリケーション開発のエキスパートシニアエンジニアです。
現在、ローカル環境に静的なプロトタイプ（HTML/CSS/JS）と詳細仕様書が完成しています。
これらを正として参照し、アンチグラビティ環境で動的に動作するアプリケーションを実装してください。

---

## 参照すべきドキュメント・リソース

### 1. 仕様書（最優先で参照）
以下のパスにある仕様書が「仕様の正」です。プロトタイプと矛盾がある場合は、仕様書を優先してください。

**仕様書ディレクトリ**: `G:\マイドライブ\社内開発\売上管理システム\仕様書\`

| ファイル名 | 内容 |
|-----------|------|
| `00_総合インデックス.md` | 仕様書全体の構成、V1.1変更点サマリ、クイックリファレンス |
| `01_システム概要とDB設計.md` | **データベース設計（ER図、全11テーブル定義）**、ユーザー権限仕様、SKU変換ルール、税率ロジック |
| `02_CSV取込処理.md` | 売上CSV・商品CSV取込の処理フロー、バリデーション |
| `03_予算管理とPL計算.md` | 予算の月別配分ロジック（端数は最終月）、PL計算式、権限による表示制御 |
| `04_画面仕様と画面遷移.md` | **全13画面の詳細仕様**、画面遷移図、共通UI仕様 |
| `05_処理フローとバリデーション.md` | バリデーションルール一覧、エラーハンドリング、権限制御 |

### 2. UI設計ドキュメント
**UI設計ディレクトリ**: `G:\マイドライブ\社内開発\売上管理システム\UI設計\`

| ファイル名 | 内容 |
|-----------|------|
| `デザインシステム.md` | カラーパレット、タイポグラフィ、スペーシング等のデザイントークン |
| `コンポーネント設計.md` | ボタン、フォーム、テーブル等のUIコンポーネント仕様 |
| `画面レイアウト設計.md` | 共通レイアウト（ヘッダー・フッター・メインエリア）の構成 |

### 3. 静的プロトタイプ（UIリファレンス）
**プロトタイプディレクトリ**: `G:\マイドライブ\社内開発\売上管理システム\プロトタイプ\`

| パス | 内容 |
|------|------|
| `index.html` | トップページ（ダッシュボード）のHTML構造 |
| `pages/*.html` | 各機能画面のHTML構造（12ファイル） |
| `css/style.css` | スタイル定義 |
| `js/app.js` | クライアントサイドロジック（計算、検索、ソート、タブ切替等） |
| `js/dummy-data.js` | ダミーデータ構造（参考用、正式なDB設計は仕様書を参照） |

---

## 重要な仕様ポイント（仕様書より抜粋）

### データベース設計
- **11テーブル構成**: users, products, sales_records, monthly_budgets, period_budgets, period_budget_histories, ad_expenses, ad_categories, tax_rates, import_histories, new_product_candidates
- 詳細は `01_システム概要とDB設計.md` のセクション3を参照

### ユーザー権限（V1.1追加）
- **マスター権限**: すべての機能にアクセス可能
- **スタッフ権限**: 月次PL・期間PLの「総合計」が非表示（商品別PLは閲覧可）
- 詳細は `01_システム概要とDB設計.md` のセクション2を参照

### SKU → 親コード変換ルール（V1.1変更）
- Rule1: `^(RINO-[A-Z0-9]+)` → RINO-形式
- Rule2: `^(RINO[A-Z]+[0-9]{3,4})` → RINOハイフン無し形式
- Rule3: その他 → そのまま
- 詳細は `01_システム概要とDB設計.md` のセクション4を参照

### 期間予算の端数処理（V1.1変更）
- **余りは最終月に寄せる**（V1.0では最初の月だった）
- 詳細は `03_予算管理とPL計算.md` を参照

### 画面構成（V1.3統合後: 13画面）
- SC-09: 予算設定画面（月別・期間を統合）
- SC-14: 広告費管理画面（一覧・入力・カテゴリ管理を統合、タブUI）
- 削除された画面: SC-08, SC-10, SC-15, SC-16, SC-17, SC-19
- 詳細は `04_画面仕様と画面遷移.md` を参照

---

## 実装ステップの指示

1. **プロジェクト初期化**: アンチグラビティのプロジェクトを作成
2. **データベース構築**: `01_システム概要とDB設計.md` のテーブル定義に基づき、全11テーブルを作成
3. **認証・権限機能**: ユーザーログインとマスター/スタッフ権限の制御を実装
4. **共通レイアウト**: `index.html` のヘッダー構造と `04_画面仕様と画面遷移.md` の共通UI仕様に基づき実装
5. **画面実装**: 以下の優先順位で実装
   - 商品マスタ一覧・編集（SC-05, SC-06）
   - 売上CSV取込（SC-02）
   - 予算設定（SC-09）
   - PL画面（SC-12, SC-13）
   - 広告費管理（SC-14）

---

## 注意事項

- **仕様書が正**: プロトタイプのダミーデータ構造（`dummy-data.js`）は参考程度に留め、正式なDB設計は仕様書に従うこと
- **削除された機能を実装しない**: 広告費CSV取込（手入力のみ）、不完全マスタ一覧画面（警告のみで対応）など
- **将来拡張は実装しない**: マルチブランド対応、日次PL、商品別広告費配賦、API連携など
- 不明点がある場合は、仕様書を確認し、それでも不明な場合は質問すること
